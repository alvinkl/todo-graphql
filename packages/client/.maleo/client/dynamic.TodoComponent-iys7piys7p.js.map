{"version":3,"file":"dynamic.TodoComponent-iys7piys7p.js","sources":["webpack://[name]/./gql-context.js","webpack://[name]/./gql-withgql.js","webpack://[name]/./src/TodoList.jsx","webpack://[name]/./src/TodoComponent.jsx"],"sourcesContent":["import { createContext } from 'react';\n\nconst GraphQLClientContext = createContext();\n\nexport default GraphQLClientContext;\n","import React from 'react';\nimport hoistStatics from 'hoist-non-react-statics';\n\nimport GraphQLClientContext from './gql-context';\n\nexport const withClient = options => ComposedComponent => {\n  const { query = '', variables = {} } = options;\n  const key = ComposedComponent.name;\n\n  class GQLHoC extends React.Component {\n    static contextType = GraphQLClientContext;\n\n    refetch = (k = key) => this.context.setRefetch(k, true);\n    doneRefetch = (k = key) => this.context.setRefetch(k, false);\n\n    state = {\n      data: null,\n      loading: true,\n      errors: null,\n      refetch: this.refetch,\n      mutation: null,\n    };\n\n    constructor(props, context) {\n      super(props, context);\n\n      this.context.client.appendQuery(key, {\n        query,\n        variables,\n      });\n    }\n\n    componentDidMount() {\n      this.query(this.context.client.queries[key]);\n    }\n\n    componentWillReceiveProps(nextProps, nextContext) {\n      const isRefetch = nextContext.refetches[key];\n\n      if (isRefetch) {\n        this.query(this.context.client.queries[key]);\n        this.doneRefetch();\n      }\n    }\n\n    query = ({ query, variables }) => {\n      this.context.client\n        .query({ query, variables })\n        .then(result =>\n          this.setState({\n            data: result.data.data,\n            errors: result.data.errors || null,\n            loading: false,\n          }),\n        )\n        .catch(error =>\n          this.setState({\n            errors: [error],\n            loading: false,\n          }),\n        );\n    };\n\n    mutate = ({ mutation, variables, refetch = false }) => {\n      this.context.client\n        .mutate({ mutation, variables })\n        .then(result => {\n          this.setState(\n            {\n              mutation: {\n                data: result.data.data,\n                errors: result.data.errors || null,\n                loading: false,\n              },\n            },\n            () => {\n              if (typeof refetch === 'boolean') {\n                return refetch && this.refetch();\n              }\n\n              if (typeof refetch === 'string') {\n                return this.refetch(refetch);\n              }\n\n              if (Array.isArray(refetch)) {\n                return refetch.map(key => this.refetch(key));\n              }\n            },\n          );\n        })\n        .catch(error =>\n          this.setState({\n            mutation: {\n              errors: [error],\n              loading: false,\n            },\n          }),\n        );\n    };\n\n    render() {\n      return (\n        <ComposedComponent\n          {...this.props}\n          graphql={this.state}\n          refetch={this.refetch}\n          mutate={this.mutate}\n        />\n      );\n    }\n  }\n\n  return hoistStatics(GQLHoC, ComposedComponent);\n};\n\nexport default withClient;\n","import React from 'react';\nimport withClient from '../gql-withgql';\n\nconst generateStyle = status => {\n  let style = { listStyleType: 'none', border: '1px solid', margin: '5px' };\n\n  if (status === 'BACKLOG') {\n    style = {\n      ...style,\n      color: 'blue',\n      borderColor: 'blue',\n    };\n  }\n\n  if (status === 'DONE') {\n    style = {\n      ...style,\n      color: 'green',\n      borderColor: 'green',\n    };\n  }\n\n  if (status === 'ON_PROGRESS') {\n    style = {\n      ...style,\n      color: 'lightblue',\n      borderColor: 'lightblue',\n    };\n  }\n\n  return style;\n};\n\nexport const ListTodoList = ({\n  data,\n  liStyle = {},\n  selectStatus,\n  updateStatus,\n}) => (\n  <li key={data.id} style={{ ...generateStyle(data.status), ...liStyle }}>\n    <p>\n      <strong>{data.description}</strong>\n    </p>\n    <select\n      onChange={e => updateStatus({ id: data.id, status: e.target.value })}\n      value={data.status}\n    >\n      <option />\n      {selectStatus.map(d => (\n        <option key={d.key} value={d.value}>\n          {d.value}\n        </option>\n      ))}\n    </select>\n    <p>{data.user.name}</p>\n  </li>\n);\n\nexport const TodoList = props => {\n  const {\n    data,\n    wrapperStyle = {},\n    liStyle = {},\n    graphql: { data: gqlData },\n    mutate,\n    mutateRefetch,\n  } = props;\n\n  return (\n    <ul style={{ margin: 0, padding: 0, ...wrapperStyle }}>\n      {data.map(d =>\n        ListTodoList({\n          data: d,\n          liStyle,\n          selectStatus: gqlData ? gqlData.status : [],\n          updateStatus: ({ id, status }) =>\n            mutate({\n              mutation,\n              variables: { id, status },\n              refetch: mutateRefetch,\n            }),\n        }),\n      )}\n    </ul>\n  );\n};\n\nconst query = `\n  {\n    status {\n      key\n      value\n    }\n  }\n`;\n\nconst mutation = `\n  mutation ($id: ID!, $status: TodoStatusEnum!) {\n    updateStatus(id: $id, status: $status) {\n      id,\n      description,\n      status,\n      user {\n        name\n      }\n    }\n  }\n`;\n\nexport default withClient({ query })(TodoList);\n","import React from 'react';\n\nimport TodoList from './TodoList';\n\nimport withClient from '../gql-withgql';\n\nconst style = {\n  wrap: {\n    display: 'flex',\n  },\n  boardList: {\n    display: 'inline-block',\n    width: (100 - 5) / 3 + '%',\n    height: 500,\n    border: '1px solid black',\n    padding: 5,\n    textAlign: 'center',\n    margin: 5,\n  },\n};\n\nexport class TodoComponent extends React.Component {\n  renderTodo = () => {\n    const {\n      graphql: {\n        data: { todos },\n      },\n    } = this.props;\n\n    const data = todos.filter(t => t.status === 'TODO');\n\n    return <TodoList data={data} mutateRefetch=\"TodoComponent\" />;\n  };\n\n  renderOnProgress = () => {\n    const {\n      graphql: {\n        data: { todos },\n      },\n    } = this.props;\n\n    const data = todos.filter(t => t.status === 'ON_PROGRESS');\n\n    return <TodoList data={data} mutateRefetch=\"TodoComponent\" />;\n  };\n\n  renderDone = () => {\n    const {\n      graphql: {\n        data: { todos },\n      },\n    } = this.props;\n\n    const data = todos.filter(t => t.status === 'DONE');\n\n    return <TodoList data={data} mutateRefetch=\"TodoComponent\" />;\n  };\n\n  render() {\n    const {\n      graphql: { loading },\n    } = this.props;\n\n    if (loading) {\n      return <div>Loading Todo ...</div>;\n    }\n\n    return (\n      <div style={style.wrap}>\n        <div style={style.boardList}>{this.renderTodo()}</div>\n        <div style={style.boardList}>{this.renderOnProgress()}</div>\n        <div style={style.boardList}>{this.renderDone()}</div>\n      </div>\n    );\n  }\n}\n\nexport default withClient({\n  query: `\n    {\n      todos {\n        id\n        description\n        status\n        user {\n          name\n          id\n        }\n      }\n    }\n  `,\n})(TodoComponent);\n"],"mappings":";;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAEA;AAEA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACJA;AACA;AAEA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AACA;AAHA;AAAA;AAAA;AAAA;AACA;AAiBA;AAAA;AACA;AADA;AACA;AAAA;AACA;AAFA;AAXA;AAAA;AAAA;AACA;AAUA;AAVA;AAAA;AAAA;AACA;AASA;AAPA;AACA;AACA;AACA;AACA;AALA;AACA;AAOA;AAsBA;AAAA;AACA;AAAA;AACA;AAAA;AAAA;AACA;AAEA;AACA;AACA;AAHA;AADA;AAOA;AAEA;AACA;AAFA;AADA;AAMA;AACA;AAvCA;AAwCA;AAAA;AAAA;AAAA;AACA;AAAA;AACA;AAAA;AAAA;AAEA;AAEA;AACA;AACA;AACA;AAHA;AADA;AAQA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AACA;AAEA;AACA;AAEA;AACA;AACA;AAFA;AADA;AADA;AAQA;AACA;AAzEA;AACA;AACA;AAFA;AACA;AAJA;AAOA;AACA;AA1BA;AAAA;AAAA;AA4BA;AACA;AA7BA;AAAA;AAAA;AAgCA;AACA;AACA;AACA;AACA;AACA;AACA;AAtCA;AAAA;AAAA;AAgGA;AAGA;AACA;AACA;AAJA;AAOA;AAxGA;AACA;AADA;AAAA;AACA;AAGA;AAuGA;AACA;AA5GA;AA8GA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACnHA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AAEA;AACA;AAHA;AAKA;AACA;AACA;AACA;AAEA;AACA;AAHA;AAKA;AACA;AACA;AACA;AAEA;AACA;AAHA;AAKA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAMA;AAAA;AAAA;AAKA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAFA;AAKA;AACA;AAAA;AAAA;AADA;AAfA;AAyBA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAUA;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AAEA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAEA;AACA;AAAA;AAAA;AAAA;AACA;AAHA;AADA;AAJA;AADA;AAeA;AAEA;AASA;AAaA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC7GA;AAEA;AAEA;AAEA;AACA;AACA;AADA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAPA;AAJA;AAeA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AACA;AADA;AACA;AADA;AACA;AADA;AAAA;AAAA;AACA;AADA;AACA;AADA;AACA;AAOA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AACA;AACA;AAZA;AAaA;AAOA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AACA;AACA;AAxBA;AAyBA;AAOA;AAAA;AAAA;AAEA;AAAA;AAAA;AAAA;AACA;AACA;AApCA;AAAA;AACA;AADA;AAAA;AAAA;AAqCA;AACA;AAIA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AAAA;AACA;AAAA;AACA;AAAA;AAGA;AArDA;AACA;AADA;AAAA;AAwDA;AACA;AADA;;;;A","sourceRoot":""}